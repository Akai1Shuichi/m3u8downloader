<ui:FluentWindow
    x:Class="m3u8Downloader.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:m3u8Downloader.View.Controls"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:m3u8Downloader.ViewModel"
    Title="MultiStream Downloader"
    Width="700"
    Height="550"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    ExtendsContentIntoTitleBar="True"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    WindowBackdropType="Mica"
    WindowCornerPreference="Round"
    WindowStartupLocation="CenterScreen"
    Icon="Resource/Image/app.ico">


    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <ui:TitleBar
            Title="MultiStream Downloader"
            Grid.Row="0"/>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20" Orientation="Vertical">

                <!--  Input  -->
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <local:LabeledInput
                        Grid.Column="0"
                        Label="Nhập URL"
                        PlaceHolder="https://..."
                        Text="{Binding Url, Mode=TwoWay}" />

                    <ui:Button
                        Grid.Column="1"
                        Width="100"
                        Margin="10,0,0,0"
                        VerticalAlignment="Bottom"
                        Command="{Binding CheckSizeCommand}"
                        Content="Check size"
                        Foreground="White"
                        Style="{StaticResource PrimaryButton}" />

                </Grid>

                <StackPanel Orientation="Vertical">
                    <TextBlock
                        Margin="0,0,0,4"
                        Foreground="White"
                        Text="Thư mục video" />

                    <StackPanel Margin="0,0,0,10" Orientation="Horizontal">
                        <local:LabeledInput
                            Width="400"
                            PlaceHolder="Nhập đường dẫn lưu video"
                            Text="{Binding VideoPath, Mode=TwoWay}" />
                        <ui:Button
                            Command="{Binding BrowseFolderCommand}"
                            Content="Chọn"
                            Foreground="White"
                            Style="{StaticResource PrimaryButton}" />

                    </StackPanel>
                </StackPanel>

                <Expander Margin="0,4,0,0" Header="Cài đặt thông số">
                    <StackPanel Margin="10">

                        <!--  Max Worker  -->
                        <StackPanel
                            Margin="0,0,0,10"
                            HorizontalAlignment="Left"
                            Orientation="Vertical">
                            <TextBlock
                                Margin="0,0,0,4"
                                Foreground="White"
                                Text="Số luồng" />
                            <ui:NumberBox
                                Width="120"
                                BorderBrush="DodgerBlue"
                                Minimum="1"
                                Value="{Binding MaxWorker, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </StackPanel>

                        <!--  Headers  -->

                        <StackPanel Orientation="Vertical">
                            <StackPanel Margin="0,0,0,4" Orientation="Horizontal">
                                <TextBlock
                                    VerticalAlignment="Center"
                                    Foreground="White"
                                    Text="Headers" />
                                <TextBlock Margin="6,0,0,0" VerticalAlignment="Center">
                                    <Hyperlink
                                        NavigateUri="https://chromewebstore.google.com/search/B%E1%BA%AFt%20Link%20Phim"
                                        RequestNavigate="Hyperlink_RequestNavigate"
                                        TextDecorations="{x:Null}"
                                        ToolTip="Cài extension 'Bắt Link Phim' để tự động lấy headers">
                                        <Border
                                            Width="18"
                                            Height="18"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Background="Transparent"
                                            BorderBrush="DodgerBlue"
                                            BorderThickness="1"
                                            CornerRadius="9"
                                            Cursor="Hand">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="BorderBrush" Value="DodgerBlue" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="DodgerBlue" />
                                                            <Setter Property="BorderBrush" Value="DodgerBlue" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>

                                            <TextBlock
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                FontSize="12"
                                                FontWeight="Bold"
                                                Text="?">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="DodgerBlue" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=Border}}" Value="True">
                                                                <Setter Property="Foreground" Value="White" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                    </Hyperlink>
                                </TextBlock>

                            </StackPanel>
                            <ui:TextBox
                                Height="200"
                                AcceptsReturn="True"
                                BorderBrush="DodgerBlue"
                                BorderThickness="1"
                                PlaceholderText="accept: */*&#x0A;accept-encoding: gzip, deflate, br, zstd&#x0A;accept-language: en-GB,en-US;q=0.9,en;q=0.8,vi;q=0.7&#x0A;origin: https://goatembed.com&#x0A;referer: https://goatembed.com/&#x0A;sec-ch-ua: &quot;Chromium&quot;;v=&quot;140&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;, &quot;Google Chrome&quot;;v=&quot;140&quot;&#x0A;sec-ch-ua-mobile: ?0&#x0A;sec-ch-ua-platform: &quot;Windows&quot;&#x0A;sec-fetch-dest: empty&#x0A;sec-fetch-mode: cors&#x0A;sec-fetch-site: cross-site&#x0A;user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
                                Text="{Binding Headers, Mode=TwoWay}"
                                TextWrapping="Wrap"
                                VerticalScrollBarVisibility="Auto" />
                        </StackPanel>

                    </StackPanel>
                </Expander>


                <!--  Kết quả (multiline)  -->

                <TextBlock
                    Margin="0,10,0,4"
                    Foreground="White"
                    Text="Kết quả" />
                <TextBox
                    Name="ResultTextBox"
                    Height="150"
                    AcceptsReturn="True"
                    BorderBrush="DodgerBlue"
                    BorderThickness="1"
                    HorizontalScrollBarVisibility="Auto"
                    IsReadOnly="True"
                    Text="{Binding Result, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                    TextWrapping="Wrap"
                    VerticalScrollBarVisibility="Auto" />

                <!--  Buttons  -->
                <StackPanel
                    Margin="0,10,0,0"
                    HorizontalAlignment="Left"
                    Orientation="Horizontal">
                    <ui:Button
                        Width="100"
                        Margin="0,0,10,0"
                        Padding="10,5"
                        Command="{Binding DownloadCommand}"
                        Content="Tải"
                        Foreground="White"
                        IsEnabled="{Binding IsDownloading, Converter={StaticResource InverseBooleanConverter}}"
                        Style="{StaticResource PrimaryButton}" />

                    <ui:Button
                        Width="100"
                        Margin="0,0,10,0"
                        Padding="10,5"
                        Command="{Binding PauseCommand}"
                        Content="Dừng"
                        Foreground="White"
                        IsEnabled="{Binding IsDownloading}"
                        Style="{StaticResource SecondaryButton}" />

                </StackPanel>

                <!--  Footer  -->
                <Grid Margin="0,30,0,0" HorizontalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!--  Bên trái  -->
                    <StackPanel
                        Grid.Column="0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Image
                            Width="16"
                            Height="16"
                            Source="Resource/Image/facebook.png"
                            Stretch="Uniform" />
                        <TextBlock Margin="6,0,0,0" Foreground="White">
                            <Hyperlink
                                NavigateUri="https://www.facebook.com/profile.php?id=61567027726244"
                                RequestNavigate="Hyperlink_RequestNavigate"
                                ToolTip="Fanpage : Thích Lập Trình">
                                Fanpage : Thích Lập Trình
                            </Hyperlink>
                        </TextBlock>
                    </StackPanel>

                    <!--  Bên phải  -->
                    <StackPanel
                        Grid.Column="1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Image
                            Width="16"
                            Height="16"
                            Source="Resource/Image/tiktok.png"
                            Stretch="Uniform" />
                        <TextBlock Margin="6,0,0,0" Foreground="White">
                            <Hyperlink
                                NavigateUri="https://www.tiktok.com/@trtoantech"
                                RequestNavigate="Hyperlink_RequestNavigate"
                                ToolTip="Tiktok: @trtoantech">
                                Tiktok: @trtoantech
                            </Hyperlink>
                        </TextBlock>
                    </StackPanel>
                </Grid>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</ui:FluentWindow>
